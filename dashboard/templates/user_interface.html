<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SmartSort - Waste Classification</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>♻️</text></svg>">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="{{ url_for('static', filename='css/user_interface.css') }}" rel="stylesheet">
</head>
<body>
    <div class="container-fluid h-100">
        <div class="row h-100">
            <!-- Main Content -->
            <div class="col-12 d-flex flex-column justify-content-center align-items-center">
                <!-- Header -->
                <div class="text-center mb-5">
                </div>

                <!-- System Initializing Overlay -->
                <div class="initializing-overlay" id="initializing-overlay" style="display: none;">
                    <div class="initializing-content">
                        <div class="initializing-icon">
                            <i class="fas fa-cog fa-spin"></i>
                        </div>
                        <h3 class="initializing-title">System Initializing</h3>
                        <p class="initializing-message">Please run integrated_auto_capture.py to start the system</p>
                        <div class="initializing-steps">
                            <div class="step">
                                <i class="fas fa-terminal"></i>
                                <span>1. Open terminal in the dashboard directory</span>
                            </div>
                            <div class="step">
                                <i class="fas fa-play"></i>
                                <span>2. Run: python3 integrated_auto_capture.py</span>
                            </div>
                            <div class="step">
                                <i class="fas fa-check"></i>
                                <span>3. Wait for "System Ready" message</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Camera Feed -->
                <div class="camera-feed-container mb-4">
                    <div class="camera-feed-wrapper">
                        <video id="camera-feed" autoplay muted playsinline></video>
                        <div class="scan-overlay">
                            <p class="scan-text">Scan Trash</p>
                        </div>
                    </div>
                </div>

                <!-- Processing Component -->
                <div class="processing-container mb-4" id="processing-container" style="display: none;">
                    <div class="processing-card">
                        <div class="processing-content">
                            <div class="processing-icon" id="processing-icon">
                                <i class="fas fa-brain"></i>
                            </div>
                            <h3 class="processing-title" id="processing-title">Processing Classification</h3>
                            <p class="processing-message" id="processing-message">Running AI inference...</p>
                        </div>
                    </div>
                </div>

                <!-- Guessing Interface -->
                <div class="guessing-interface" id="guessing-interface" style="display: none;">
                    <div class="guessing-card">
                        <div class="guessing-header">
                            <h3 class="guessing-title">Guess the Classification!</h3>
                            <div class="timer-display">
                                <div class="timer-circle" id="timer-circle">
                                    <span class="timer-text" id="timer-text">5</span>
                                </div>
                            </div>
                        </div>
                        <div class="guessing-options">
                            <div class="row">
                                <div class="col-4">
                                    <button class="btn btn-outline-primary btn-guess" onclick="makeGuess('recycle')">
                                        <i class="fas fa-recycle me-2"></i>
                                        Recycle
                                    </button>
                                </div>
                                <div class="col-4">
                                    <button class="btn btn-outline-secondary btn-guess" onclick="makeGuess('waste')">
                                        <i class="fas fa-trash me-2"></i>
                                        Waste
                                    </button>
                                </div>
                                <div class="col-4">
                                    <button class="btn btn-outline-success btn-guess" onclick="makeGuess('organic')">
                                        <i class="fas fa-leaf me-2"></i>
                                        Organic
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Guess Result -->
                <div class="guess-result" id="guess-result" style="display: none;">
                    <div class="result-card">
                        <div class="result-icon" id="guess-result-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <h3 class="result-title" id="guess-result-title">Correct!</h3>
                        <p class="result-message" id="guess-result-message">Great job! You guessed correctly.</p>
                        <div class="comparison-details">
                            <div class="comparison-item">
                                <span class="label">Your Guess:</span>
                                <span class="value" id="user-guess">Recycle</span>
                            </div>
                            <div class="comparison-item">
                                <span class="label">Actual:</span>
                                <span class="value" id="actual-classification">Recycle</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Classification Result -->
                <div class="classification-result" id="classification-result" style="display: none;">
                    <div class="result-content">
                        <div class="result-icon" id="result-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <h2 class="result-title" id="result-title">Classification Complete</h2>
                        <div class="result-details">
                            <div class="classification-badge" id="classification-badge">
                                <span class="badge-text" id="badge-text">Plastic</span>
                            </div>
                            <div class="confidence-bar">
                                <div class="confidence-fill" id="confidence-fill" style="width: 0%"></div>
                            </div>
                            <p class="confidence-text" id="confidence-text">Confidence: 0%</p>
                        </div>
                        <div class="disposal-instructions" id="disposal-instructions">
                            <button class="btn btn-warning btn-override" onclick="showOverrideOptions()">
                                <i class="fas fa-exclamation-triangle me-2"></i>
                                Manual Override
                            </button>
                        </div>
                        
                        <!-- Override Options (hidden initially) -->
                        <div class="override-options" id="override-options" style="display: none;">
                            <div class="row mt-3">
                                <div class="col-4">
                                    <button class="btn btn-outline-primary btn-option" onclick="selectOverride('recycle')">
                                        <i class="fas fa-recycle me-2"></i>
                                        Recycle
                                    </button>
                                </div>
                                <div class="col-4">
                                    <button class="btn btn-outline-secondary btn-option" onclick="selectOverride('waste')">
                                        <i class="fas fa-trash me-2"></i>
                                        Waste
                                    </button>
                                </div>
                                <div class="col-4">
                                    <button class="btn btn-outline-success btn-option" onclick="selectOverride('organic')">
                                        <i class="fas fa-leaf me-2"></i>
                                        Organic
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Instructions -->
                <div class="instructions mt-4">
                    <div class="row text-center">
                        <div class="col-md-4 mb-3">
                            <div class="instruction-item">
                                <i class="fas fa-hand-paper fa-2x mb-2 text-primary"></i>
                                <h6>1. Place waste on platform</h6>
                                <small class="text-muted">Position your waste item on the platform</small>
                            </div>
                        </div>
                        <div class="col-md-4 mb-3">
                            <div class="instruction-item">
                                <i class="fas fa-brain fa-2x mb-2 text-warning"></i>
                                <h6>2. Guess the classification</h6>
                                <small class="text-muted">Think about what type of waste it is</small>
                            </div>
                        </div>
                        <div class="col-md-4 mb-3">
                            <div class="instruction-item">
                                <i class="fas fa-clock fa-2x mb-2 text-success"></i>
                                <h6>3. Wait for results</h6>
                                <small class="text-muted">See if your guess was correct</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <script src="{{ url_for('static', filename='js/user_interface.js') }}"></script>
</body>
</html>
